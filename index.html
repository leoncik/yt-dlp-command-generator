<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>yt-dlp Command Generator</title>
    <style>
      #download-time-range ~ fieldset {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Build your command</h1>
    <p>Configure options and copy the ready-made command</p>

    <form>
      <h2>Configuration</h2>
      <p>Customize your download options</p>

      <div class="form-group">
        <label for="video-url"> Video URL </label>
        <input id="video-url" type="text" />
      </div>

      <div class="form-group">
        <fieldset>
          <legend>Quality Preset</legend>

          <input id="best" name="quality" type="radio" value="best" checked />
          <label for="best">Best</label>

          <input id="1080p" name="quality" type="radio" value="1080p" />
          <label for="1080p">1080p</label>

          <input id="720p" name="quality" type="radio" value="720p" />
          <label for="720p">720p</label>

          <input id="audio" name="quality" type="radio" value="audio" />
          <label for="audio">Audio</label>
        </fieldset>
      </div>

      <div class="form-group">
        <label for="download-time-range" name="download-time-range">
          Download Time range
        </label>
        <input id="download-time-range" type="checkbox" />

        <fieldset>
          <legend>Start Time</legend>
          <label for="start-h">h</label>
          <input type="number" id="start-h" name="start-h" />

          <label for="start-m">m</label>
          <input type="number" id="start-m" name="start-m" />

          <label for="start-s">s</label>
          <input type="number" id="start-s" name="start-s" />
        </fieldset>

        <fieldset>
          <legend>End Time</legend>
          <label for="end-h">h</label>
          <input type="number" id="end-h" name="end-h" />

          <label for="end-m">m</label>
          <input type="number" id="end-m" name="end-m" />

          <label for="end-s">s</label>
          <input type="number" id="end-s" name="end-s" />
        </fieldset>
      </div>

      <div class="form-group">
        <label for="exclude-playlist" name="exclude-playlist">
          Exclude playlist
        </label>
        <input id="exclude-playlist" type="checkbox" />
      </div>

      <div class="form-group">
        <label for="custom-output-name" name="custom-output-name">
          Custom Output Name
        </label>
        <input id="custom-output-name" type="checkbox" />
      </div>
    </form>

    <div>
      <h2>Generated command</h2>
      <pre>
        yt-dlp "&lt;URL&gt;"
      </pre>
      <button>Copy</button>
    </div>
    <script>
      // Main form inputs
      const videoUrlInput = document.getElementById("video-url");
      const bestCheckbox = document.getElementById("best");
      const p1080Checkbox = document.getElementById("1080p");
      const p720Checkbox = document.getElementById("720p");
      const audioCheckbox = document.getElementById("audio");
      const timeRangeCheckbox = document.getElementById("download-time-range");
      const excludePlaylistCheckbox =
        document.getElementById("exclude-playlist");
      const customOutputCheckbox =
        document.getElementById("custom-output-name");

      // Time inputs
      const startH = document.getElementById("start-h");
      const startM = document.getElementById("start-m");
      const startS = document.getElementById("start-s");
      const endH = document.getElementById("end-h");
      const endM = document.getElementById("end-m");
      const endS = document.getElementById("end-s");

      // Output elements
      const commandOutput = document.querySelector("pre");
      const copyButton = document.querySelector("button");

      // Time range fieldsets
      const timeFieldsets = document.querySelectorAll(
        "#download-time-range ~ fieldset"
      );

      // The mighty function to update your beloved command.
      function updateCommand() {
        let command = "yt-dlp";

        // Add quality/format option
        if (audioCheckbox.checked) {
          command += " -x --audio-format mp3";
        } else if (p1080Checkbox.checked) {
          command +=
            ' -f "bestvideo[height<=1080]+bestaudio/best[height<=1080]"';
        } else if (p720Checkbox.checked) {
          command += ' -f "bestvideo[height<=720]+bestaudio/best[height<=720]"';
        } else if (bestCheckbox.checked) {
          command += ' -f "bestvideo+bestaudio/best"';
        }

        // Add time range options
        if (timeRangeCheckbox.checked) {
          const startTime = formatTime(
            startH.value,
            startM.value,
            startS.value
          );
          const endTime = formatTime(endH.value, endM.value, endS.value);
          command += ` --download-sections "*${startTime}-${endTime}"`;
        }

        // Add exclude playlist option
        if (excludePlaylistCheckbox.checked) {
          command += " --no-playlist";
        }

        // Add custom output name option
        if (customOutputCheckbox.checked) {
          command += ' -o "%(title)s.%(ext)s"';
        }

        // Add URL
        const url = videoUrlInput.value.trim();
        command += ` "${url || "<URL>"}"`;

        commandOutput.textContent = command;
      }

      // Function to format time as HH:MM:SS
      function formatTime(hours, minutes, seconds) {
        const h = String(hours || 0).padStart(2, "0");
        const m = String(minutes || 0).padStart(2, "0");
        const s = String(seconds || 0).padStart(2, "0");
        return `${h}:${m}:${s}`;
      }

      // Toggle time range visibility
      timeRangeCheckbox.addEventListener("change", () => {
        const display = timeRangeCheckbox.checked ? "block" : "none";
        timeFieldsets.forEach((fieldset) => {
          fieldset.style.display = display;
        });
      });

      // Listening to all inputs 	|ω･)ﾉ
      videoUrlInput.addEventListener("input", updateCommand);
    </script>
  </body>
</html>
