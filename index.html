<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>yt-dlp Command Generator</title>
    <style>
      /* General stuff */
      :root {
        --background-color: hsl(222, 47%, 8%);
        --primary: hsl(262, 83%, 58%);
        --border-color: hsl(217, 33%, 20%);
        --ring: var(--primary);
        --card-hover-bg: hsl(262, 82%, 20%);
        --muted: hsl(215, 20%, 55%);
        --14px: 0.875rem;
        --18px: 1.125rem;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      label {
        display: block;
      }

      input[type="text"] {
        margin-top: 8px;
        width: 100%;
        height: 2.5rem;
        padding: 0.5rem 0.75rem;
        background-color: var(--background-color);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: var(--14px);
        color: white;
        transition: all 0.2s;
      }

      /* Hiding the arrows for the number inputs... */
      /* Chrome, Safari, Edge, Opera */
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      /* Firefox */
      input[type="number"] {
        -moz-appearance: textfield;
      }

      input[type="number"] {
        margin-top: 4px;
        width: 100%;
        height: 2.5rem;
        padding: 0.5rem 0.75rem;
        background-color: var(--background-color);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: var(--14px);
        color: white;
        transition: all 0.2s;
      }

      body {
        padding: 32px;
        background-color: var(--background-color);
        color: white;
        margin-left: auto;
        margin-right: auto;
        max-width: 42rem;
        font-family: sans-serif;
      }

      header {
        text-align: center;
      }

      form,
      .output-wrapper {
        background-color: hsl(222, 47%, 11%);
        border-radius: 12px;
        padding: 24px;
      }

      fieldset {
        border: none;
      }

      .togglable-options {
        margin-top: 24px;
        padding: 16px;
        background-color: hsla(217, 33%, 17%, 0.3);
      }

      .output-wrapper {
        margin-top: 24px;
      }

      .time-fieldsets-wrapper {
        display: none;
        margin-top: 16px;
      }

      /* Header */
      header p {
        margin-top: 8px;
        color: var(--muted);
      }

      /* Form */
      form {
        margin-top: 32px;
      }

      .form-group {
        margin-top: 24px;
      }

      .form-group.first {
        margin-top: 0;
      }

      form h2 {
        font-size: var(--18px);
      }

      .configuration-sub-title {
        margin-top: 6px;
        margin-bottom: 16px;
        color: var(--muted);
      }

      /* Radio cards stuff */
      .quality-preset-cards-wrapper {
        margin-top: 12px;
        display: flex;
        gap: 8px;
        justify-content: space-between;
        flex-wrap: wrap;
      }

      .radio-card {
        position: relative;
        flex: 1;
      }

      .radio-card input[type="radio"] {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
        margin: 0;
      }

      .radio-card label {
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0.25rem;
        padding: 0.75rem 1rem;
        border: 1px solid var(--border-color);
        background-color: var(--background-color);
        border-radius: 0.375rem;
        transition: all 0.2s;
        height: 100%;
        min-height: 4rem;
      }

      .radio-card label svg {
        width: 1rem;
        height: 1rem;
      }

      .radio-card label span {
        font-size: 0.75rem;
      }

      .radio-card input[type="radio"]:checked + label {
        background-color: var(--primary);
        border-color: var(--primary);
      }

      .radio-card input[type="radio"]:hover + label {
        background-color: var(--card-hover-bg);
      }

      .radio-card input[type="radio"]:checked:hover + label {
        background-color: hsla(262, 83%, 58%, 0.9);
      }

      .radio-card input[type="radio"]:focus-visible + label {
        outline: 2px solid var(--ring);
        outline-offset: 2px;
      }

      /* Toggle-switch stuff */
      .toggle-row {
        display: flex;
        justify-content: space-between;
      }

      /* Aligns the Icon and the Label Text */
      .toggle-label-group {
        display: flex;
        align-items: center;
        gap: 0.5rem; /* Space between icon and text */
        cursor: pointer;
      }

      /* Ensure the SVG inside doesn't shrink */
      .toggle-label-group svg {
        flex-shrink: 0;
        width: 1.25rem;
        height: 1.25rem;
        color: var(--muted);
      }

      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 3rem; /* 48px */
        height: 1.75rem; /* 28px */
        flex-shrink: 0; /* Prevents shrinking in flex containers */
      }

      /* Hide default HTML checkbox but keep it accessible for screen readers */
      .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
        position: absolute; /* Prevent layout displacement */
      }

      /* The slider (track) */
      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: hsl(217, 33%, 20%); /* Default off color */
        transition: 0.3s;
        border-radius: 2rem;
      }

      /* The slider thumb (circle) */
      .slider:before {
        position: absolute;
        content: "";
        height: 1.25rem; /* 20px */
        width: 1.25rem;
        left: 0.25rem;
        bottom: 0.25rem;
        background-color: var(--background-color);
        transition: 0.3s;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      /* Checked State */
      .toggle-switch input:checked + .slider {
        background-color: var(--primary);
      }

      .toggle-switch input:checked + .slider:before {
        transform: translateX(1.25rem); /* Move thumb to the right */
      }

      /* Accessibility: Focus Ring */
      .toggle-switch input:focus-visible + .slider {
        outline: 2px solid var(--ring);
        outline-offset: 2px;
      }

      /* Update .toggle-row to align items vertically */
      .toggle-row {
        display: flex;
        justify-content: space-between;
        align-items: center; /* Ensures text and switch are vertically centered */
      }

      /* Time inputs */
      .time-fieldset {
        color: var(--muted);
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .start-time-fieldset {
        margin-top: 16px;
      }

      /* Custom name stuff */
      #custom-output-field label {
        color: var(--muted);
      }

      /* Generated command stuff */
      .output-wrapper h2 {
        color: var(--muted);
        font-size: var(--14px);
        font-weight: 500;
      }

      .command-wrapper {
        margin-top: 12px;
      }

      /* Code block */
      .command-wrapper pre {
        background: hsl(217, 33%, 17%);
        padding: 1rem;
        border-radius: 0.5rem;
        overflow-x: auto;
        font-size: 0.875rem;
        line-height: 1.4;
        white-space: pre-wrap;
        word-break: break-all;
      }

      /* Copy button */
      .copy-btn {
        width: 100%;
        margin-top: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;

        height: 2.25rem;
        padding: 0 0.75rem;

        background: var(--primary);
        color: white;
        border: none;
        border-radius: 0.375rem;

        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
      }

      .copy-btn:hover {
        background: hsla(262, 83%, 58%, 0.9);
      }

      /* Copied (success) state */
      .copy-btn.copied {
        background: hsl(142, 71%, 45%);
      }

      .copy-btn.copied:hover {
        background: hsl(142, 71%, 40%);
      }

      .copy-btn.copied:focus-visible {
        box-shadow: 0 0 0 2px white, 0 0 0 4px hsl(142, 71%, 45%);
      }

      /* Focus ring */
      .copy-btn:focus-visible {
        outline: none;
        box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary);
      }

      /* Disabled state */
      .copy-btn:disabled {
        opacity: 0.5;
        pointer-events: none;
      }

      /* Icon */
      .copy-btn svg {
        width: 1rem;
        height: 1rem;
        stroke: currentColor;
        fill: none;
        stroke-width: 2;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Build your command</h1>
      <p>Configure options and copy the ready-made command</p>
    </header>

    <form>
      <h2>Configuration</h2>
      <p class="configuration-sub-title">Customize your download options</p>

      <div class="form-group first">
        <label for="video-url"> Video URL / Embed Code </label>
        <input id="video-url" type="text" />
      </div>

      <div class="form-group">
        <fieldset>
          <legend>Quality Preset</legend>

          <div class="quality-preset-cards-wrapper">
            <div class="radio-card">
              <input
                id="best"
                name="quality"
                type="radio"
                value="best"
                checked=""
              />
              <label for="best">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                  <path d="M7 3v18"></path>
                  <path d="M3 7.5h4"></path>
                  <path d="M3 12h18"></path>
                  <path d="M3 16.5h4"></path>
                  <path d="M17 3v18"></path>
                  <path d="M17 7.5h4"></path>
                  <path d="M17 16.5h4"></path>
                </svg>
                <span>Best</span>
              </label>
            </div>

            <div class="radio-card">
              <input id="1080p" name="quality" type="radio" value="1080p" />
              <label for="1080p">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                  <path d="M7 3v18"></path>
                  <path d="M3 7.5h4"></path>
                  <path d="M3 12h18"></path>
                  <path d="M3 16.5h4"></path>
                  <path d="M17 3v18"></path>
                  <path d="M17 7.5h4"></path>
                  <path d="M17 16.5h4"></path>
                </svg>
                <span>1080p</span>
              </label>
            </div>

            <div class="radio-card">
              <input id="720p" name="quality" type="radio" value="720p" />
              <label for="720p">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect width="18" height="18" x="3" y="3" rx="2"></rect>
                  <path d="M7 3v18"></path>
                  <path d="M3 7.5h4"></path>
                  <path d="M3 12h18"></path>
                  <path d="M3 16.5h4"></path>
                  <path d="M17 3v18"></path>
                  <path d="M17 7.5h4"></path>
                  <path d="M17 16.5h4"></path>
                </svg>
                <span>720p</span>
              </label>
            </div>

            <div class="radio-card">
              <input id="audio" name="quality" type="radio" value="audio" />
              <label for="audio">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 18V5l12-2v13"></path>
                  <circle cx="6" cy="18" r="3"></circle>
                  <circle cx="18" cy="16" r="3"></circle>
                </svg>
                <span>Audio</span>
              </label>
            </div>

            <div class="radio-card">
              <input
                id="audio-mp3"
                name="quality"
                type="radio"
                value="audio-mp3"
              />
              <label for="audio-mp3">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 18V5l12-2v13"></path>
                  <circle cx="6" cy="18" r="3"></circle>
                  <circle cx="18" cy="16" r="3"></circle>
                </svg>
                <span>MP3</span>
              </label>
            </div>
          </div>
        </fieldset>
      </div>

      <div class="togglable-options">
        <div class="form-group">
          <div class="toggle-row">
            <div class="toggle-label-group">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              <label for="download-time-range"> Download Time range </label>
            </div>

            <label class="toggle-switch">
              <input id="download-time-range" type="checkbox" role="switch" />
              <span class="slider"></span>
            </label>
          </div>

          <div
            id="time-fieldsets-wrapper"
            class="time-fieldsets-wrapper"
            style="display: none"
          >
            <fieldset class="time-fieldset start-time-fieldset">
              <legend>Start Time</legend>
              <input type="number" id="start-h" name="start-h" />
              <label for="start-h">h</label>

              <input type="number" id="start-m" name="start-m" />
              <label for="start-m">m</label>

              <input type="number" id="start-s" name="start-s" />
              <label for="start-s">s</label>
            </fieldset>

            <fieldset class="time-fieldset">
              <legend>End Time</legend>
              <input type="number" id="end-h" name="end-h" />
              <label for="end-h">h</label>

              <input type="number" id="end-m" name="end-m" />
              <label for="end-m">m</label>

              <input type="number" id="end-s" name="end-s" />
              <label for="end-s">s</label>
            </fieldset>
          </div>
        </div>

        <div class="form-group">
          <div class="toggle-row">
            <div class="toggle-label-group">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"
                ></path>
                <path d="m9.5 10.5 5 5"></path>
                <path d="m14.5 10.5-5 5"></path>
              </svg>
              <label for="exclude-playlist">Exclude playlist</label>
            </div>

            <label class="toggle-switch">
              <input id="exclude-playlist" type="checkbox" role="switch" />
              <span class="slider"></span>
            </label>
          </div>
        </div>

        <div class="form-group">
          <div class="toggle-row">
            <div class="toggle-label-group">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"
                ></path>
                <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
                <path d="M10 9H8"></path>
                <path d="M16 13H8"></path>
                <path d="M16 17H8"></path>
              </svg>
              <label for="custom-output-name">Custom Output Name</label>
            </div>

            <label class="toggle-switch">
              <input id="custom-output-name" type="checkbox" role="switch" />
              <span class="slider"></span>
            </label>
          </div>

          <fieldset id="custom-output-field" hidden style="margin-top: 16px">
            <legend>
              <label for="output-template">File name</label>
            </legend>

            <input
              id="output-template"
              type="text"
              placeholder="Any name you want…"
            />
          </fieldset>
        </div>
      </div>
    </form>

    <div class="output-wrapper">
      <h2>Generated command</h2>

      <div class="command-wrapper">
        <pre><code>yt-dlp -x --audio-format mp3 "&lt;URL&gt;"</code></pre>

        <button class="copy-btn">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <rect x="8" y="8" width="14" height="14" rx="2"></rect>
            <path
              d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"
            ></path>
          </svg>
          Copy Command
        </button>
      </div>
    </div>

    <script>
      // Main form inputs
      const videoUrlInput = document.getElementById("video-url");
      const bestCheckbox = document.getElementById("best");
      const p1080Checkbox = document.getElementById("1080p");
      const p720Checkbox = document.getElementById("720p");
      const audioCheckbox = document.getElementById("audio");
      const audioMp3Checkbox = document.getElementById("audio-mp3");
      const timeRangeCheckbox = document.getElementById("download-time-range");
      const excludePlaylistCheckbox =
        document.getElementById("exclude-playlist");
      const customOutputCheckbox =
        document.getElementById("custom-output-name");

      // Time inputs
      const startH = document.getElementById("start-h");
      const startM = document.getElementById("start-m");
      const startS = document.getElementById("start-s");
      const endH = document.getElementById("end-h");
      const endM = document.getElementById("end-m");
      const endS = document.getElementById("end-s");

      // Output elements
      const commandOutput = document.querySelector("pre");
      const copyButton = document.querySelector("button");

      // Time range fieldsets wrapper
      const timeFieldsetsWrapper = document.getElementById(
        "time-fieldsets-wrapper"
      );

      // Custom output name fieldset and input
      const customOutputField = document.getElementById("custom-output-field");
      const outputTemplateInput = document.getElementById("output-template");

      // LocalStorage helpers
      const STORAGE_KEY = "yt-dlp-form";

      function saveState() {
        const state = {
          best: bestCheckbox.checked,
          p1080: p1080Checkbox.checked,
          p720: p720Checkbox.checked,
          audio: audioCheckbox.checked,
          audioMp3: audioMp3Checkbox.checked,

          timeRange: timeRangeCheckbox.checked,
          excludePlaylist: excludePlaylistCheckbox.checked,
          customOutput: customOutputCheckbox.checked,
        };

        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      }

      function loadState() {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return;

        const state = JSON.parse(raw);

        bestCheckbox.checked = state.best;
        p1080Checkbox.checked = state.p1080;
        p720Checkbox.checked = state.p720;
        audioCheckbox.checked = state.audio;
        audioMp3Checkbox.checked = state.audioMp3;

        timeRangeCheckbox.checked = state.timeRange;
        excludePlaylistCheckbox.checked = state.excludePlaylist;
        customOutputCheckbox.checked = state.customOutput;

        // Restore UI visibility
        timeFieldsetsWrapper.style.display = timeRangeCheckbox.checked
          ? "block"
          : "none";
        customOutputField.style.display = customOutputCheckbox.checked
          ? "block"
          : "none";
      }

      // The mighty function to update your beloved command.
      function updateCommand() {
        let command = "yt-dlp";

        // Add quality/format option
        if (audioMp3Checkbox.checked) {
          command += " -x --audio-format mp3";
        } else if (audioCheckbox.checked) {
          command += " -x";
        } else if (p1080Checkbox.checked) {
          command +=
            ' -f "bestvideo[height<=1080]+bestaudio/best[height<=1080]"';
        } else if (p720Checkbox.checked) {
          command += ' -f "bestvideo[height<=720]+bestaudio/best[height<=720]"';
        } else if (bestCheckbox.checked) {
          command += ' -f "bestvideo+bestaudio/best"';
        }

        // Add time range options
        if (timeRangeCheckbox.checked) {
          const startTime = formatTime(
            startH.value,
            startM.value,
            startS.value
          );
          const endTime = formatTime(endH.value, endM.value, endS.value);
          command += ` --download-sections "*${startTime}-${endTime}"`;
        }

        // Add exclude playlist option
        if (excludePlaylistCheckbox.checked) {
          command += " --no-playlist";
        }

        // Add custom output name option
        if (customOutputCheckbox.checked) {
          const template =
            outputTemplateInput.value.trim() || "%(title)s.%(ext)s";
          command += ` -o "${template}"`;
        }

        // Add URL
        const url = videoUrlInput.value.trim();
        command += ` "${url || "<URL>"}"`;

        commandOutput.textContent = command;

        // Save after every change
        saveState();
      }

      // Function to format time as HH:MM:SS
      function formatTime(hours, minutes, seconds) {
        const h = String(hours || 0).padStart(2, "0");
        const m = String(minutes || 0).padStart(2, "0");
        const s = String(seconds || 0).padStart(2, "0");
        return `${h}:${m}:${s}`;
      }

      // Toggle time range visibility
      timeRangeCheckbox.addEventListener("change", () => {
        timeFieldsetsWrapper.style.display = timeRangeCheckbox.checked
          ? "block"
          : "none";
        updateCommand();
      });

      // Toggle custom output name visibility
      customOutputCheckbox.addEventListener("change", () => {
        customOutputField.style.display = customOutputCheckbox.checked
          ? "block"
          : "none";
        updateCommand();
      });

      // Listening to all inputs 	|ω･)ﾉ
      videoUrlInput.addEventListener("input", updateCommand);
      outputTemplateInput.addEventListener("input", updateCommand);

      // Add event listeners for all quality radio buttons
      [
        bestCheckbox,
        p1080Checkbox,
        p720Checkbox,
        audioCheckbox,
        audioMp3Checkbox,
      ].forEach((radio) => {
        radio.addEventListener("change", updateCommand);
      });

      // Time inputs
      [startH, startM, startS, endH, endM, endS].forEach((input) => {
        input.addEventListener("input", updateCommand);
      });

      excludePlaylistCheckbox.addEventListener("change", updateCommand);

      // Copy to clipboard
      let copyResetTimer = null;

      copyButton.addEventListener("click", async () => {
        try {
          await navigator.clipboard.writeText(commandOutput.textContent);

          const originalHTML =
            copyButton.dataset.originalHtml ||
            (copyButton.dataset.originalHtml = copyButton.innerHTML);

          // Clear any previous timer
          if (copyResetTimer) {
            clearTimeout(copyResetTimer);
          }

          // Apply success state
          copyButton.classList.add("copied");
          copyButton.innerHTML = `
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      Copied!
    `;

          // Start a fresh 2s timer
          copyResetTimer = setTimeout(() => {
            copyButton.classList.remove("copied");
            copyButton.innerHTML = copyButton.dataset.originalHtml;
            copyResetTimer = null;
          }, 2000);
        } catch (err) {
          console.error("Failed to copy:", err);
        }
      });

      // Load saved state first
      loadState();

      // Initialize command on page load
      updateCommand();
    </script>
  </body>
</html>
